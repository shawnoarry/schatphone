# SchatPhone 操作指南（新版）

更新时间：2026-02-11

本指南用于日常开发、验收和提交流程，内容已与当前代码同步。

## 1. 开发前准备

进入目录：

```bash
cd h:\SchatPhone\schatphone
```

安装依赖并启动：

```bash
npm install
npm run dev
```

## 2. 你最常用的页面

- Home：`/home`
- Settings：`/settings`
- Profile：`/profile`
- WorldBook：`/worldbook`
- Network：`/network`
- Appearance：`/appearance`
- Chat：`/chat`

## 3. Home 交互规则（当前）

### 3.1 进入编辑

- 在 Home 桌面空白处长按进入“编辑主屏”。

### 3.2 编辑能力

- 拖拽排序（同屏）
- 跨屏拖拽（贴边自动换屏）
- 重置默认布局

### 3.3 删除/隐藏规则

- 功能入口（`app_*`）：不可删除/隐藏，只能换位置
- Widget 与自定义 Widget：可隐藏
- 隐藏后无空白占位，网格自动重排

### 3.4 屏幕数量

- 默认 5 屏（前 2 屏有内容，后 3 屏预留）

## 4. Settings 分层说明

Settings 首页：
- 用户卡片（进入 Profile）
- 内容设置：世界书、通用、通知
- 数据与安全：备份导出、关于

独立入口：
- Network（API）
- Appearance（美化 + Widget）

Appearance 二级菜单：
- 整体主题美化：主题、壁纸、自定义 CSS
- 字体：全局字体预设、自定义字体栈
- Widget：模板、创建、导入、管理

## 5. 保存规则

关键输入页均有显式保存按钮：
- Settings（通用/通知）
- Profile
- WorldBook
- Network
- Appearance

同时系统保留自动持久化（双保险）。

## 6. 自定义 Widget 快速操作

1. 进入 `/appearance`
2. 进入 `Widget` 二级菜单
3. 可先复制或导出“通用模板”作为创作起点
4. 填写名称、尺寸、目标屏、代码并添加
5. 回到 `/home` 查看并拖拽到目标位置

内置 Widget 恢复：
- 在 `Widget` 二级菜单中使用“内置 Widget 恢复”面板。
- 可单项把隐藏的内置 Widget 加回指定屏，也可把已显示的内置 Widget 直接移动到指定屏。

导入方式：
- 在 Appearance 的导入区粘贴 JSON 数组后导入

## 7. 网络 API 快速操作

1. 进入 `/network`
2. 输入 URL + Key
3. 刷新模型列表（或等待自动拉取）
4. 选择模型，保存设置
5. 可保存为预设并通过下拉快速切换

## 8. 新增功能标准流程

1. 新建页面：`src/views/XXXView.vue`
2. 注册路由：`src/router/index.js`
3. 评估是否需要 Home 入口
4. 状态放入对应 store（system/chat/map）
5. AI 请求统一走：`src/lib/ai.js`
6. 涉及输入则补保存按钮
7. 更新文档：`PROJECT_STATUS.md` 与 `ARCHITECTURE.md`

## 9. 提交前检查（必做）

```bash
npm run lint
npm run build
```

建议同时执行：

```bash
npm run test
```

## 10. 部署流程（GitHub Pages）

```bash
git add .
git commit -m "feat: your message"
git push origin main
```

推送后由 GitHub Actions 自动部署。

## 11. 常见问题

1. 看起来修改没生效
- 检查是否点击保存按钮
- 刷新后再验证

2. Home 入口仍是旧布局
- 可能是本地缓存布局
- 在 Home 编辑栏点击“重置”恢复默认

3. 模型拉取失败
- 先查 URL/Key
- 再查跨域和网关限制
- 可手动填写模型兜底
